<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Totty Dime's Slot Machine</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="background">
    <img src="slot-machine.jpeg" alt="Slot Machine" class="slot-background" />
    <div class="overlay">
      <h1>Totty Dime's Slot Machine</h1>
      <div class="slot-machine">
        <div class="reel" id="reel1">🐶</div>
        <div class="reel" id="reel2">🦁</div>
        <div class="reel" id="reel3">🐲</div>
      </div>
      <button id="spinButton">SPIN</button>
      <div id="popup" class="hidden">
        <p>Try again?</p>
        <button id="retryButton">SPIN AGAIN</button>
      </div>
      <div id="winScreen" class="hidden">
        <img src="jackpot-image.jpeg" alt="Jackpot Icon" />
        <h2>YOU WON A DIME… A TOTTY DIME</h2>
      </div>
    </div>
  </div>

  <!-- Suoni -->
  <audio id="spinSound" src="spin.mp3" preload="auto"></audio>
  <audio id="winSound" src="win.mp3" preload="auto"></audio>

  <!-- Script -->
  <script>
    const symbols = ["🐶", "🦁", "🦦", "🐲"];
    const jackpotSymbol = '<img src="jackpot-image.jpeg" alt="Jackpot" class="jackpot-icon">';

    let spinCount = 0;
    const reel1 = document.getElementById("reel1");
    const reel2 = document.getElementById("reel2");
    const reel3 = document.getElementById("reel3");
    const spinButton = document.getElementById("spinButton");
    const retryButton = document.getElementById("retryButton");
    const popup = document.getElementById("popup");
    const winScreen = document.getElementById("winScreen");
    const spinSound = document.getElementById("spinSound");
    const winSound = document.getElementById("winSound");

    // Sblocca audio su mobile al primo tocco
    document.body.addEventListener("click", () => {
      spinSound.play().then(() => spinSound.pause()).catch(() => {});
      winSound.play().then(() => winSound.pause()).catch(() => {});
    }, { once: true });

    function spinReels() {
      if (spinSound) {
        spinSound.currentTime = 0;
        spinSound.play().catch(() => {});
      }

      reel1.classList.add("spinning");
      reel2.classList.add("spinning");
      reel3.classList.add("spinning");

      let interval = setInterval(() => {
        reel1.textContent = symbols[Math.floor(Math.random() * symbols.length)];
        reel2.textContent = symbols[Math.floor(Math.random() * symbols.length)];
        reel3.textContent = symbols[Math.floor(Math.random() * symbols.length)];
      }, 100);

      setTimeout(() => {
        clearInterval(interval);
        reel1.classList.remove("spinning");
        reel2.classList.remove("spinning");
        reel3.classList.remove("spinning");

        spinCount++;

        if (spinCount === 1) {
          reel1.textContent = symbols[0];
          reel2.textContent = symbols[1];
          reel3.textContent = symbols[2];
          popup.classList.remove("hidden");
        } else {
          reel1.innerHTML = jackpotSymbol;
          reel2.innerHTML = jackpotSymbol;
          reel3.innerHTML = jackpotSymbol;
          popup.classList.add("hidden");
          winScreen.classList.remove("hidden");
          if (winSound) {
            winSound.currentTime = 0;
            winSound.play().catch(() => {});
          }
        }
      }, 2000);
    }

    spinButton.addEventListener("click", spinReels);
    retryButton.addEventListener("click", spinReels);
  </script>
</body>
</html>
